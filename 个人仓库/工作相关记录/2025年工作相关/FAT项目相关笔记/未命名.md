现在单点的测试流程发生了变化，由原来的并行自动测试改变为检测通道及接线自动测试，点位反馈及报警手动点击确认

前半段自动化测试(通道及接线正确性测试)：根据选择的测试组的自动完成如下测试
AI点位：
    0%-100%的阶段对比值自动测试
AO点位：
     0%-100%的阶段对比值自动测试
DI点位：
     DI点位开关量接收自动测试
DO点位：
     DO点位开关量下发自动测试

后半段人工介入测试(为了满足输出点位的需求需要切换至测试模式下进行，禁用程序内逻辑判断后的输出)：
AI点位：
1、通道反馈值测试由测试人员手动输入自定义值下发后人工确认
2、低低报测试(手动点击下发小于低低报的数值(小1)，下发后测试人员确认测试是否成功)，包含数值复位功能
3、高高报测试(手动点击下发小于高高报的数值(大1)，下发后测试人员确认测试是否成功)，包含数值复位功能
4、下发维护命令，下发后测试人员确认是否切换至测试模式
AO点位：
1、通道反馈值测试包含在高高低低报警测试内
2、低低报测试(手动点击下发小于低低报的数值(小1)，下发后测试人员确认测试是否成功)，包含数值复位功能
3、高高报测试(手动点击下发小于高高报的数值(大1)，下发后测试人员确认测试是否成功)，包含数值复位功能
4、下发维护命令，下发后测试人员确认是否切换至测试模式
DI点位：
1、通道反馈由测试人员下发取反及复位命令，由测试人员确认
DO点位：
1、通道输出由测试人员下发取反及复位命令，由测试人员确认



现在让我们来完成测试任务的编排逻辑：
测试流程分为两部分，让我们先来完成自动测试部分：
要求如下：需要的接口和类已经定义好了，请你先看一遍整个项目的代码了解之后在下面的程序上进行修改和完善，不要新增类。只修改ITestTaskManager和TestTaskManager，其他暂时不要修改

测试任务管理接口：ITestTaskManager
测试任务管理类：TestTaskManager
通讯接口：IPlcCommunication
通讯类：ModbusTcpCommunication

测试过程中弹出等待的对话框，测试结束后自动关闭这个等待对话框请你修改完之后编译一下，确认没有错误
一、自动测试部分
自动测试主要完成硬点的自动测试，批次选择完成之后点击完成接线确认才能放开通道硬点自动测试的点击权限。
点击完成接线确认之后测试任务编排服务开始生成并行进行的任务表并开始执行

对于AI点位的测试步骤如下：
1、向测试PLC的AO点位写入行程区间的0%
等待3秒之后读取被测PLC对应的AI点位的数值进行比对，更新测试结果
2、向测试PLC的AO点位写入行程区间的25%
等待3秒之后读取被测PLC对应的AI点位的数值进行比对，更新测试结果
3、向测试PLC的AO点位写入行程区间的50%
等待3秒之后读取被测PLC对应的AI点位的数值进行比对，更新测试结果
4、向测试PLC的AO点位写入行程区间的75%
等待3秒之后读取被测PLC对应的AI点位的数值进行比对，更新测试结果
5、向测试PLC的AO点位写入行程区间的100%
等待3秒之后读取被测PLC对应的AI点位的数值进行比对，更新测试结果
6、测试完成之后将测试PLC的AO点位恢复为0%

对于AO点位的测试步骤如下
1、向被测试PLC的AO点位写入行程区间的0%
等待3秒之后读取测试PLC对应的AI点位的数值进行比对，更新测试结果
2、向被测试PLC的AO点位写入行程区间的25%
等待3秒之后读取测试PLC对应的AI点位的数值进行比对，更新测试结果
3、向被测试PLC的AO点位写入行程区间的50%
等待3秒之后读取测试PLC对应的AI点位的数值进行比对，更新测试结果
4、向被测试PLC的AO点位写入行程区间的75%
等待3秒之后读取测试PLC对应的AI点位的数值进行比对，更新测试结果
5、向被测试PLC的AO点位写入行程区间的100%
等待3秒之后读取测试PLC对应的AI点位的数值进行比对，更新测试结果
6、测试完成之后将被测试PLC的AO点位恢复为0%

对于DI点位的测试步骤如下：
1、向测试PLC的DO点位写入true。等待3秒之后读取被测PLC对应的DI点位数值确认是不是true。
2、向测试PLC的DO点位写入flase。等待3秒之后读取被测PLC对应的DI点位数值确认是不是flase。
3、更新测试结果

对于DO点位的测试步骤如下：
1、向被测试PLC的DO点位写入true。等待3秒之后读取测试PLC对应的DI点位数值确认是不是true。
2、向被测试PLC的DO点位写入flase。等待3秒之后读取测试PLC对应的DI点位数值确认是不是flase。
3、更新测试结果


现在请你检查一下如下几点：
1、选择完批次之后测试结果区域的数据全部消失了。不论什么时候这个区域得数据都不应该整体替换和消失
2、测试开始不应该是点击完成接线确认就开始，而是点击完成接线创建测试任务同时将通道硬点自动测试由不可点击设置为可点击。
3、我发现你确实增加了点击完成接线确认的验证。但是我觉得应该做成用户没有选择测试批次得时候就无法点击。选择完批次之后才可以点击
4、等待测试得画面也没有调用出来

请你先阅读代码再进行修改，修改完之后编译确认没有错误。














我需要你帮我完成如下的功能：
当用户点击测试队列显示区域的打开手动测试窗口按钮后根据对应的通道类型打开对应的手动测试窗口，只修改DataEditView中的代码，先不要修改其他代码
AI点位窗口：
第一区域(显示值核对)：设定值输入框、测试值下发按钮、确认通过按钮
第二区域(高报及高高报核对区域)：下发测试命令按钮、复位按钮、确认通过按钮
第三区域(低报及低低报核对区域)：下发测试命令按钮、复位按钮、确认通过按钮
第四区域(维护功能核对区域)：下发测试命令按钮、复位按钮、确认通过按钮


DI点位窗口：
第一区域(反馈状态核对区域)：下发测试命令按钮、复位按钮、确认通过按钮




我现在还需要实现另一个功能：
根据用户点击的测试条目的通道类型类对应的显示和隐藏手动测试环节的打开手动测试窗口按钮。
AI点位点击手动测试窗口按钮后打开前面定义的AI手动测试窗口
AO点位隐藏手动测试窗口按钮
DI点位点击手动测试窗口按钮后打开前面定义的DI手动测试窗口
DO点位隐藏手动测试窗口按钮.

请你同时完成DataEditViewModel中的相关处理逻辑



我希望能够在保持美观的同时将横向再缩短150左右，同时纵向也把空白区域缩短一些。保持横向和纵向比例的协调。
第二个问题，批次选择窗口和手动测试窗口都存在点击窗口外的区域后就自动关闭了，请你帮我解决这个问题，除非用户点击关闭否则不会退出


我现在有两处需要修改的地方：
一、我现在需要你帮我创建一下DO和AO的手动测试窗口。
这个窗口的样式也是和之前的AI、AO的窗口设计类似。这个窗口中只有如下的内容：
监测状态提示：请开始监测、监测中、成功获取变化   这三种情况
检测值显示区域
开始检测按钮
确认通过按钮
请你帮我完成界面的设计。
二、调整手动测试窗口中的画面和相关逻辑
前提条件，测试结果中的ResultText字段存储最后的综合结果，还需要添加一个硬点通道的测试结果用于存储印硬点通道的测试结果
1. 调整AI手动测试窗口的所有确认通过按钮为点击后将自动记录状态至TestResult的对应字段中：低低报结果、低报结果、高报结果、高高报结果，如果点击过后就将状态设置为通过，如果没有点击就设置为未测试。同时将这四个按钮的颜色状态绑定至对应的点位上
2. 同理DI手动测试窗口的确认通过按钮也将状态保存在测试结果中此结果也动态的绑定至确认通过按钮的颜色中。
3. AO和DO的手动测试窗口的确认通过按钮也将结果记录至测试结果实例中并动态绑定颜色

现在有如下的问题：
1、AO和DO中的手动测试窗口点击开始检测之后所有的同类型点位都变为检测中了，这个状态应该存在每个ChannelMapping的点位中。
2、AI中原本的高报高高报、低报低低报、维护功能核对的确认通过按钮消失了，请你帮我恢复
3、DI中原本的确认通过按钮消失了，请你帮我恢复
4、每个手动测试窗口中的确认通过按钮没有动态的绑定到TestResult的实例属性中，前面我要求记录这个结果同时改变按钮的颜色，这个功能没有生效


现在有如下问题：
1、我的确认通过按钮显示为白色，而不是颜色转换器中设定的颜色，点击后也没有任何反应
2、AO和DO点击后测试状态也没有更新




我现在完成了总体程序的一半工作量，我发现了一个比较严重的问题，我的TestResult和ChannelMapping中存在很多重复的字段，而且在ViewModel中数值来回同步刷新，写了很多不必要的代码。我希望你帮我创建这两个数据体的并集，以ChannelMapping作为结果集，通俗来说就是查看TestResult中的每一个子元素如果和ChannelMapping有对应关系就丢弃，如果没有对应关系就添加到ChannelMapping中。
我需要你切记如下重点：
1、请你先梳理原来的所有引用了TestResult的地方
2、梳理完成之后完成数据体替换。
3、请多次检查确保能一次替换完成且不出现错误



现在让我们来一步一步的解决因为TestResult迁移导致的Bug（请确保在修改时从全局代码的角度来考虑相关的影响）：
1、选择批次窗口点击之后测试队列显示区域没有任何内容
2、测试结果中测试PLC通道位号没有成功映射
3、DI和DO类型的测试结果区域：低低报反馈状态、低报反馈状态、高报反馈状态、高高报反馈状态、维护功能检测都应该是NaN而不是空
4、应该将DI和DO类型的0%对比值、25%对比值、50%对比值、75%对比值、100%对比值都设置为NaN
5、对于AI和AO点位的0%对比值、25%对比值、50%对比值、75%对比值、100%对比值在初始化的时候都不应该有值而是在测试后将得到的反馈结果记录进示例中同步的显示到测试结果区域


现在让我们来一步一步的解决因为TestResult迁移导致的Bug（请确保在修改时从全局代码的角度来考虑相关的影响）：
1、选择批次窗口点击之后测试队列显示区域没有任何内容
2、测试结果中测试PLC通道位号没有成功映射
测试之后我发现还是批次选择和测试PLC通道在TestResult没有正确的映射的原因。我感觉应该和我选择的这段代码有关系。其中这个currentChannels我觉得可以留下，其他的我觉得完全可以和为一个整体。目前currentChannels的方式有两种。分类型放在集合中或者放在一个ObservableCollection中，只在需要分类的时候进行筛选。请你从全局和优良架构的层面选择一下。对于合并后的结果请将所有代码中涉及到的读取和修改操作都修改为正确的引用



好的现在功能已经基本正常了，我现在需要你帮我从全局的角度查看一下AIChannels、AOChannels、DIChannels、DOChannels、TestResults、CurrentTestResult这几个集合。我从功能性的角度来看这几个集合与AllChannels和CurrentChannels中的数据存在重合，其中AllChannels用于存放所有的数据作为数据池使用，而CurrentChannels作为测试批次选择的展示中间数据，我现在计划只保留AllChannels这个集合就可以完成所有的数据处理和操作，保留CurrentChannels用于通道映射中的分批选择和显示。当需要修改的时候还是修改测试AllChannels中的数据。请你先从全局代码的角度梳理一下他们之间的关系。然后帮我将所有涉及到的结构和调用结构都重新修改，将会涉及到很多的接口和实现类中方法的入参。请你一定要全方位的梳理和修改。确保一次成功


